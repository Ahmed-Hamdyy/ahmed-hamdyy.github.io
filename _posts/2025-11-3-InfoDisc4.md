---
title: Authentication bypass via information disclosure
date: 2025-11-03 00:00:00 +0800
categories: [Portswigger, Information disclosure]
tags: [portswigger, writeup, walkthrough, web, information, disclosure]     # TAG names should always be lowercase
description: In this post we will solve an Information Disclosure Lab on portswigger, have fun reading.
---

## Lab: Authentication bypass via information disclosure

This lab's administration interface has an authentication bypass vulnerability, but it is impractical to exploit without knowledge of a custom HTTP header used by the front-end.

To solve the lab, obtain the header name then use it to bypass the lab's authentication. Access the admin interface and delete the user `carlos`.

You can log in to your own account using the following credentials: `wiener:peter`

### Lab 4 Exploitation

Open the website and let's discover it, but first make sure you have opened burpsuite in the background so cause we will need to play with the requests.

The lab description says to us that there is an admin interface which we need to get access to so we will need to find this interface, you can bruteforce it with a simple wordlist but i have found it with the first guess which of course was `/admin`

![img-description](/assets/img/PortSwigger/Information_Disclosure/4/admin.png)
_Admin Interface_

It tells us that the **Admin interface only available to local users** so let's see how can we bypass that.

Send the request to the repeater **CTRL+R** and let's play with it.

When i was reading about http methods i found this method:

>Developers might forget to disable various debugging options in the production environment. For example, the HTTP `TRACE` method is designed for diagnostic purposes. If enabled, the web server will respond to requests that use the `TRACE` method by echoing in the response the exact request that was received.

So let's see the response with this method.

![img-description](/assets/img/PortSwigger/Information_Disclosure/4/trace.png)
_Trace Method_

and we can see that there is a header which seems interesting which is `X-Custom-IP-Authorization:`

**X-Custom-IP-Authorization** usually used to pass a clientâ€™s IP address to the server or backend service, often when the real client IP is hidden behind a proxy, CDN, or load balancer.

and our public ip is with the header, so the website is sending our ip with the request and blocking us from accessing the interface because we are not local users.

when reading the header definition we can also see that it can be used in spoofing our ip address, so we will add it in the request with the local ip address and send the request.

![img-description](/assets/img/PortSwigger/Information_Disclosure/4/local.png)
_Local User_

It worked we now have access to the admin interface and we need to delete the user carlos.

You can see in the source code the endpoint to delete carlos put it in the request as in the image and let's send the request again 

![img-description](/assets/img/PortSwigger/Information_Disclosure/4/Delete.png)
_Deleting Carlos_

and you will find that the lab is solved

![img-description](/assets/img/PortSwigger/Information_Disclosure/4/Solved.png)
_Sovled_