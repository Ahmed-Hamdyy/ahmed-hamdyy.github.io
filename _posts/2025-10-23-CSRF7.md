---
title: SameSite Lax bypass via method override
date: 2025-10-23 00:00:00 +0800
categories: [Portswigger, Cross-site request forgery (CSRF)]
tags: [portswigger, writeup, walkthrough, web, csrf]     # TAG names should always be lowercase
description: In this post we will solve a CSRF Lab on portswigger, have fun reading.
---

## Lab: SameSite Lax bypass via method override

This lab's change email function is vulnerable to CSRF. To solve the lab, perform a CSRF attack that changes the victim's email address. You should use the provided exploit server to host your attack.

You can log in to your own account using the following credentials: `wiener:peter`

|Note
|The default SameSite restrictions differ between browsers. As the victim uses Chrome, we recommend also using Chrome (or Burp's built-in Chromium browser) to test your exploit.

### Lab 7 Exploitation

Our goal is to exploit the vulnerable functionality in this website and make sure that the csrf vulnerability works so let's start 

First we will open burpsuite before doing anything so that we can see all of the requests that our website is doing, then login to `wiener` account with the credentials we have.

![img-description](/assets/img/PortSwigger/CSRF/7/Cookie.png)
_Cookie_

The first thing we can notice is that when logging in the website it didn't grant us a `SameSite` cookie, and this is a dangerous thing because when i was reading from [Portswigger](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions) i found this very important note

| Note
|If the website issuing the cookie doesn't explicitly set a `SameSite` attribute, Chrome automatically applies `Lax` restrictions by default. This means that the cookie is only sent in cross-site requests that meet specific criteria, even though the developers never configured this behavior. As this is a proposed new standard, we expect other major browsers to adopt this behavior in future.

and also as we can see in the note which is in the lab description that our target is using Chrome, so now we now that the `SameSite` cookie by default is set to lax but what is lax?

### Lax

Lax SameSite restrictions mean that browsers will send the cookie in cross-site requests, but only if both of the following conditions are met:

- The request uses the GET method.

- The request resulted from a top-level navigation by the user, such as clicking on a link.

This means that the cookie is not included in cross-site POST requests, for example. As POST requests are generally used to perform actions that modify data or state (at least according to best practice), they are much more likely to be the target of CSRF attacks.

Likewise, the cookie is not included in background requests, such as those initiated by scripts, iframes, or references to images and other resources.

As per our information we can now try to send our change email request using get instead of post so let's try it.

![img-description](/assets/img/PortSwigger/CSRF/7/Method.png)
_Changing Method_

We got "Method Not Allowed" which means that this is also will not work on our target so we got to find a way to bypass that.

Also when i was reading on [Portswigger](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions) i found this.

**Even if an ordinary GET request isn't allowed, some frameworks provide ways of overriding the method specified in the request line. For example, Symfony supports the _method parameter in forms, which takes precedence over the normal method for routing purposes**

so let's try this way for overriding the method we will tell the website that we are sending the request in GET request so that we can bypass the lax restriction and then we will override it with this way to be POST method so that we don't get the "Method Not Allowed", let's craft our payload.

```
<html>
    <body>
        <form action="https://vulnerable-website.com/email/change" method="GET">
            <input type="hidden" name="email" value="pwned@evil-user.net" />
            <input type="hidden" name="_method" value="POST">
        </form>
        <script>
            document.forms[0].submit();
        </script>
    </body>
</html>
```

Now go to your exploit server change the data in this script to your relevant lab data and let's try it on us first.

![img-description](/assets/img/PortSwigger/CSRF/7/Changed.png)
_Changed Email_

and we can see that it worked now change the email again because no two users should have the same email and send the exploit to the victim.

![img-description](/assets/img/PortSwigger/CSRF/7/Solved.png)
_Solved_

Your script should be something like that and you will find that the lab have been solved.