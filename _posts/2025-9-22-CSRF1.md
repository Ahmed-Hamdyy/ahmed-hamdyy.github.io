---
title: CSRF vulnerability with no defenses
date: 2025-9-22 00:00:00 +0800
categories: [Portswigger, Cross-site request forgery (CSRF)]
tags: [portswigger, writeup, walkthrough, web, csrf]     # TAG names should always be lowercase
description: In this post we will solve all of the CSRF Labs on portswiggger, have fun reading.
---

## Lab: CSRF vulnerability with no defenses

This lab's email change functionality is vulnerable to CSRF.

To solve the lab, craft some HTML that uses a CSRF attack to change the viewer's email address and upload it to your exploit server.

You can log in to your own account using the following credentials: `wiener:peter`

### Lab 1 Exploitation

Our goal is to exploit the vulnerable functionality in this website and make sure that the csrf vulnerability works so let's start 

First we will open burpsuite before doing anything so that we can see all of the requests that our website is doing, then login to `wiener` account with the credentials we have.

![img-description](/assets/img/PortSwigger/CSRF/1/mail.png)
_Changing Email_

We will find that we can change our account email so put any email and click on the update email and we will see that it is updated now, after we have seen that it is updated let's see our request in burpsuite.

![img-description](/assets/img/PortSwigger/CSRF/1/req.png)
_Request_

We will see that this is the request that changed our email so we can now deduce that our functionality is vulnerable to csrf because the three conditions are in place, but what are the three conditions?

`First:` We must have a relevant action. There is an action within the application that the attacker has a reason to induce, which is in our case the change mail action

`Second:` Cookie-based session handling. Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests and we can see that clearly in our request

`Third:` No unpredictable request parameters. The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess and we will see that we only have the email parameter nothing else

After we have made sure that we have met our three conditions, let's in crafting our poc

```
<html>
    <body>
        <form action="https://vulnerable-website.com/email/change" method="POST">
            <input type="hidden" name="email" value="pwned@evil-user.net" />
        </form>
        <script>
            document.forms[0].submit();
        </script>
    </body>
</html>
```

Change the data in this code with your lab relevant data and then go to the exploit server to test it.

![img-description](/assets/img/PortSwigger/CSRF/1/Exploit.png)
_POC_

and your request should be something like this, now click on view exploit and you will see that your mail have been changed to the mail you have choosen in the code.

![img-description](/assets/img/PortSwigger/CSRF/1/changed.png)
_Changed Mail_

Now all you have to do is to change the email in the code again because no 2 users can have the same mail, and as you have the email that is in the code right now so you have to change it again.

![img-description](/assets/img/PortSwigger/CSRF/1/solved.png)
_Solved_

and you will see that the lab is solved.



